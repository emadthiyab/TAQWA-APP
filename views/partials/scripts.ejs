<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom Scripts -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // تفعيل القوائم المنسدلة
        var dropdownToggleList = [].slice.call(document.querySelectorAll('.dropdown-toggle'));
        var dropdownList = dropdownToggleList.map(function (dropdownToggle) {
            return new bootstrap.Dropdown(dropdownToggle);
        });

        // إصلاح القوائم المنسدلة على الشاشات الصغيرة
        function handleDropdownPosition() {
            const dropdowns = document.querySelectorAll('.dropdown-menu');
            dropdowns.forEach(function (dropdown) {
                const rect = dropdown.getBoundingClientRect();
                const viewportWidth = window.innerWidth;

                if (rect.right > viewportWidth) {
                    dropdown.style.left = 'auto';
                    dropdown.style.right = '0';
                }

                if (rect.left < 0) {
                    dropdown.style.right = 'auto';
                    dropdown.style.left = '0';
                }
            });
        }

        // استدعاء الدالة عند تغيير حجم النافذة
        window.addEventListener('resize', handleDropdownPosition);

        // استدعاء الدالة عند فتح dropdown
        dropdownToggleList.forEach(function (toggle) {
            toggle.addEventListener('click', function () {
                setTimeout(handleDropdownPosition, 10);
            });
        });

        // زر القائمة الجانبية للموبايل
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebarCloseBtn = document.querySelector('.sidebar-close-btn');
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.querySelector('.overlay');

        function toggleSidebar() {
            if (sidebar) sidebar.classList.toggle('show');
            if (overlay) overlay.classList.toggle('show');
        }

        function closeSidebar() {
            if (sidebar) sidebar.classList.remove('show');
            if (overlay) overlay.classList.remove('show');
        }

        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', toggleSidebar);
        }

        if (sidebarCloseBtn) {
            sidebarCloseBtn.addEventListener('click', closeSidebar);
        }

        if (overlay) {
            overlay.addEventListener('click', closeSidebar);
        }
    });
</script>